<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/style.css">

    <title>Whatsapp Web</title>
</head>

<body>
    <div class="container">
        <div class="overlay-modal">
            <div class="modal-container">
                <div class="modal-header">
                    <h3>Realize Login</h3>
                </div>
                <div class="modal-content">
                    Login: <input id="nome-usuario" type="text" placeholder="Digite o nome do seu usuÃ¡rio...">
                </div>
                <div class="modal-footer">
                    <button class="botao-modal" id="botao-blue">
                        Logar
                    </button>
                </div>
            </div>
        </div>

        <header>
            <nav>
                <div class="logo">
                    <img src="../imagens/chat-de-voz.png" alt="">
                </div>
                <span>
                    Messenger
                </span>

                <span class="usuario">
                    Ana Kely
                </span>
            </nav>
        </header>

        <div class="container-chat">

            <div class="chat">
                Chat
            </div>
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous">
        </script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script>
        /* MODAL */
        let overlayModal = document.querySelector(".overlay-modal");
        let logar = document.querySelector("#botao-blue");
        let input_nome = document.querySelector("#nome-usuario")
        console.log(input_nome)

        logar.addEventListener("click", function () {
            overlayModal.classList.add("active");
        })

        /* LISTAR GRUPOS */
        let containerChat = document.querySelector(".container-chat")

        function criarLista(id, nome) {
            let containerGroup = document.createElement("div")
            containerGroup.classList.add("list-group")

            let listGroup = document.createElement("div")
            listGroup.classList.add("grupos")

            let itemList = document.createElement("div")
            let imgGroup = document.createElement("img")
            let span = document.createElement("span")

            itemList.appendChild(imgGroup)
            imgGroup.src = '../imagens/icon-group.png'

            itemList.appendChild(imgGroup)
            itemList.appendChild(span)
            span.textContent = nome
            listGroup.appendChild(itemList)


            containerGroup.appendChild(listGroup)
            containerChat.appendChild(containerGroup)

            return containerGroup
        }

        function getGroupAndRender(grupo) {
            axios({
                method: "GET",
                url: "https://server-json-lms.herokuapp.com/grupos",
            }).then((response) => {
                let grupos = response.data
                let lista = criarLista(grupo.id, grupo.nome)
                containerChat.appendChild(listGroup)
            }).catch((error) => {
                console.log(error)
            })
        }

        function atualizarList() {
            containerChat.innerHTML = ""
            axios({
                method: "GET",
                url: "https://server-json-lms.herokuapp.com/grupos",
            }).then((response) => {
                let grupos = response.data
                for (let grupo of grupos) {
                    getGroupAndRender(grupo)
                }
            }).catch((error) => {
                console.log(error)
            })
        }

        atualizarList()

    </script>
</body>

</html>